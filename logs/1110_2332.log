2025-11-10 23:32:34 - root - INFO - Logging setup complete. Outputting to console and file: logs/1110_2332.log
2025-11-10 23:32:34 - root - INFO - Initialized all random seeds to: 42
2025-11-10 23:32:34 - __main__ - INFO - Using device: cuda
2025-11-10 23:32:34 - __main__ - INFO - Starting run: 1110_2332
2025-11-10 23:32:34 - __main__ - INFO - --- Initializing Models ---
2025-11-10 23:32:34 - root - INFO - [EmbeddingModel] Loading embedding model: all-MiniLM-L6-v2...
2025-11-10 23:32:34 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-11-10 23:32:42 - root - INFO - [EmbeddingModel] Model loaded. Embedding dimension: 384
2025-11-10 23:32:42 - models.llm_wrapper - INFO - Loading LLM environment: Qwen/Qwen3-0.6B...
2025-11-10 23:32:46 - models.llm_wrapper - INFO - LLM 'Qwen/Qwen3-0.6B' loaded successfully.
2025-11-10 23:32:46 - models.policy_network - INFO - Initializing PolicyNetwork (Type: LSTM)
2025-11-10 23:32:47 - __main__ - WARNING - Pre-trained model not found at: checkpoints/mtop_pretrained.pt
2025-11-10 23:32:47 - __main__ - WARNING - Starting PPO training from random initialization.
2025-11-10 23:32:47 - __main__ - INFO - --- Loading Data ---
2025-11-10 23:32:47 - data_utils.mtop_loader - INFO - --- Creating Corpus (Action Space) ---
2025-11-10 23:32:47 - data_utils.mtop_loader - INFO - Loading full 'train' split (no global cache used)...
2025-11-10 23:32:57 - data_utils.mtop_loader - INFO - Loading EmbeddingModel (all-MiniLM-L6-v2) for K-Means/Sampling...
2025-11-10 23:32:57 - root - INFO - [EmbeddingModel] Loading embedding model: all-MiniLM-L6-v2...
2025-11-10 23:32:57 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-11-10 23:33:05 - root - INFO - [EmbeddingModel] Model loaded. Embedding dimension: 384
2025-11-10 23:33:05 - data_utils.mtop_loader - INFO - Pre-computing all training data embeddings...
2025-11-10 23:33:07 - data_utils.mtop_loader - INFO - Full train data and embeddings loaded (15667 samples).
2025-11-10 23:33:07 - data_utils.mtop_loader - WARNING - USE_CLUSTERED_CORPUS=False. Using the *entire* training dataset (15667 samples) as corpus.
2025-11-10 23:33:07 - data_utils.mtop_loader - INFO - Corpus created. Final size: 15667
2025-11-10 23:33:07 - __main__ - INFO - Corpus embeddings computed. Shape: torch.Size([15667, 384])
2025-11-10 23:33:07 - data_utils.mtop_loader - INFO - Loading query dataloader (split=train, batch_size=16, shuffle=True)...
2025-11-10 23:33:07 - data_utils.mtop_loader - INFO - Loading 'train' split data from Hugging Face...
2025-11-10 23:33:13 - data_utils.mtop_loader - INFO - Randomly sampling 5000 examples for 'train' split...
2025-11-10 23:33:13 - data_utils.mtop_loader - INFO - Loading query dataloader (split=dev, batch_size=64, shuffle=False)...
2025-11-10 23:33:16 - __main__ - INFO - --- Initializing PPO Components ---
2025-11-10 23:33:16 - engine.sampler - INFO - EpisodeSampler initialized for 4 steps.
2025-11-10 23:33:16 - engine.reward_computer - INFO - RewardComputer initialized with GAE (gamma=0.99, lambda=0.95)
2025-11-10 23:33:16 - __main__ - INFO - --- Starting Training Loop ---
2025-11-10 23:33:16 - __main__ - INFO - --- Running Initial kNN Baseline Evaluation ---
2025-11-10 23:33:16 - __main__ - INFO - --- kNN Baseline Evaluation Finished ---
2025-11-10 23:33:16 - __main__ - INFO - Starting Epoch 1/100
2025-11-10 23:33:59 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 1...
2025-11-10 23:36:24 - __main__ - INFO - Evaluation Epoch 1 (Mode: POLICY) Finished. Accuracy: 2.15% (48/2235), Avg NLL: 0.1942
2025-11-10 23:36:24 - __main__ - INFO - Saving evaluation results to file...
2025-11-10 23:36:24 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1110_2332_epoch_1_policy.csv
2025-11-10 23:36:24 - __main__ - INFO - New best validation accuracy: 2.15%! Saving model...
2025-11-10 23:36:24 - __main__ - INFO - Starting Epoch 2/100
2025-11-10 23:37:07 - __main__ - INFO - Starting Epoch 3/100
2025-11-10 23:37:50 - __main__ - INFO - Starting Epoch 4/100
