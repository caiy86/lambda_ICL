2025-11-11 12:11:57 - root - INFO - Logging setup complete. Outputting to console and file: logs/1111_1211.log
2025-11-11 12:11:57 - root - INFO - Initialized all random seeds to: 42
2025-11-11 12:11:57 - __main__ - INFO - Using device: cuda
2025-11-11 12:11:57 - __main__ - INFO - Starting run: 1111_1211
2025-11-11 12:11:57 - __main__ - INFO - --- Initializing Models ---
2025-11-11 12:11:57 - root - INFO - [EmbeddingModel] Loading embedding model: all-MiniLM-L6-v2...
2025-11-11 12:11:57 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-11-11 12:12:03 - root - INFO - [EmbeddingModel] Model loaded. Embedding dimension: 384
2025-11-11 12:12:03 - models.llm_wrapper - INFO - Loading LLM environment: Qwen/Qwen3-0.6B...
2025-11-11 12:12:06 - models.llm_wrapper - INFO - LLM 'Qwen/Qwen3-0.6B' loaded successfully.
2025-11-11 12:12:06 - models.policy_network - INFO - Initializing PolicyNetwork (Type: LSTM)
2025-11-11 12:12:06 - __main__ - INFO - Successfully loaded pre-trained MMR weights from: checkpoints/pretrain/mtop_pretrained.pt
2025-11-11 12:12:06 - __main__ - INFO - --- Loading Data ---
2025-11-11 12:12:06 - data_utils.mtop_loader - INFO - --- Creating Corpus (Action Space) ---
2025-11-11 12:12:06 - data_utils.mtop_loader - INFO - Loading full 'train' split (no global cache used)...
2025-11-11 12:12:14 - data_utils.mtop_loader - INFO - Loading EmbeddingModel (all-MiniLM-L6-v2) for K-Means/Sampling...
2025-11-11 12:12:14 - root - INFO - [EmbeddingModel] Loading embedding model: all-MiniLM-L6-v2...
2025-11-11 12:12:14 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-11-11 12:12:20 - root - INFO - [EmbeddingModel] Model loaded. Embedding dimension: 384
2025-11-11 12:12:20 - data_utils.mtop_loader - INFO - Pre-computing all training data embeddings...
2025-11-11 12:12:21 - data_utils.mtop_loader - INFO - Full train data and embeddings loaded (15667 samples).
2025-11-11 12:12:21 - data_utils.mtop_loader - WARNING - USE_CLUSTERED_CORPUS=False. Using the *entire* training dataset (15667 samples) as corpus.
2025-11-11 12:12:21 - data_utils.mtop_loader - INFO - Corpus created. Final size: 15667
2025-11-11 12:12:21 - __main__ - INFO - Corpus embeddings computed. Shape: torch.Size([15667, 384])
2025-11-11 12:12:21 - data_utils.mtop_loader - INFO - Loading query dataloader (split=train, batch_size=16, shuffle=True)...
2025-11-11 12:12:21 - data_utils.mtop_loader - INFO - Loading 'train' split data from Hugging Face...
2025-11-11 12:12:25 - data_utils.mtop_loader - INFO - Randomly sampling 5000 examples for 'train' split...
2025-11-11 12:12:25 - data_utils.mtop_loader - INFO - Loading query dataloader (split=dev, batch_size=64, shuffle=False)...
2025-11-11 12:12:27 - __main__ - INFO - --- Initializing PPO Components ---
2025-11-11 12:12:27 - engine.sampler - INFO - EpisodeSampler initialized for 4 steps.
2025-11-11 12:12:27 - engine.reward_computer - INFO - RewardComputer initialized with GAE (gamma=0.99, lambda=0.95)
2025-11-11 12:12:27 - __main__ - INFO - --- Starting Training Loop ---
2025-11-11 12:12:27 - __main__ - INFO - --- Running Initial kNN Baseline Evaluation ---
2025-11-11 12:12:27 - __main__ - INFO - --- kNN Baseline Evaluation Finished ---
2025-11-11 12:12:27 - __main__ - INFO - Starting Epoch 1/100
2025-11-11 12:13:12 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 1...
2025-11-11 12:14:52 - __main__ - INFO - Evaluation Epoch 1 (Mode: POLICY) Finished. Accuracy: 33.20% (742/2235), Avg NLL: 0.0494
2025-11-11 12:14:52 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 12:14:52 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_1_policy.csv
2025-11-11 12:14:52 - __main__ - INFO - New best validation accuracy: 33.20%! Saving model...
2025-11-11 12:14:52 - __main__ - INFO - Starting Epoch 2/100
2025-11-11 12:15:36 - __main__ - INFO - Starting Epoch 3/100
2025-11-11 12:16:19 - __main__ - INFO - Starting Epoch 4/100
2025-11-11 12:17:03 - __main__ - INFO - Starting Epoch 5/100
2025-11-11 12:17:47 - __main__ - INFO - Starting Epoch 6/100
2025-11-11 12:18:30 - __main__ - INFO - Starting Epoch 7/100
2025-11-11 12:19:14 - __main__ - INFO - Starting Epoch 8/100
2025-11-11 12:19:58 - __main__ - INFO - Starting Epoch 9/100
2025-11-11 12:20:42 - __main__ - INFO - Starting Epoch 10/100
2025-11-11 12:21:26 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 10...
2025-11-11 12:23:03 - __main__ - INFO - Evaluation Epoch 10 (Mode: POLICY) Finished. Accuracy: 32.48% (726/2235), Avg NLL: 0.0494
2025-11-11 12:23:03 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 12:23:03 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_10_policy.csv
2025-11-11 12:23:03 - __main__ - INFO - Starting Epoch 11/100
2025-11-11 12:23:47 - __main__ - INFO - Starting Epoch 12/100
2025-11-11 12:24:32 - __main__ - INFO - Starting Epoch 13/100
2025-11-11 12:25:15 - __main__ - INFO - Starting Epoch 14/100
2025-11-11 12:25:58 - __main__ - INFO - Starting Epoch 15/100
2025-11-11 12:26:43 - __main__ - INFO - Starting Epoch 16/100
2025-11-11 12:27:27 - __main__ - INFO - Starting Epoch 17/100
2025-11-11 12:28:10 - __main__ - INFO - Starting Epoch 18/100
2025-11-11 12:28:55 - __main__ - INFO - Starting Epoch 19/100
2025-11-11 12:29:38 - __main__ - INFO - Starting Epoch 20/100
2025-11-11 12:30:22 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 20...
2025-11-11 12:31:47 - __main__ - INFO - Evaluation Epoch 20 (Mode: POLICY) Finished. Accuracy: 34.32% (767/2235), Avg NLL: 0.0492
2025-11-11 12:31:47 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 12:31:47 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_20_policy.csv
2025-11-11 12:31:47 - __main__ - INFO - New best validation accuracy: 34.32%! Saving model...
2025-11-11 12:31:47 - __main__ - INFO - Starting Epoch 21/100
2025-11-11 12:32:31 - __main__ - INFO - Starting Epoch 22/100
2025-11-11 12:33:15 - __main__ - INFO - Starting Epoch 23/100
2025-11-11 12:33:58 - __main__ - INFO - Starting Epoch 24/100
2025-11-11 12:34:42 - __main__ - INFO - Starting Epoch 25/100
2025-11-11 12:35:26 - __main__ - INFO - Starting Epoch 26/100
2025-11-11 12:36:10 - __main__ - INFO - Starting Epoch 27/100
2025-11-11 12:36:54 - __main__ - INFO - Starting Epoch 28/100
2025-11-11 12:37:37 - __main__ - INFO - Starting Epoch 29/100
2025-11-11 12:38:20 - __main__ - INFO - Starting Epoch 30/100
2025-11-11 12:39:04 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 30...
2025-11-11 12:41:01 - __main__ - INFO - Evaluation Epoch 30 (Mode: POLICY) Finished. Accuracy: 32.21% (720/2235), Avg NLL: 0.0500
2025-11-11 12:41:01 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 12:41:01 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_30_policy.csv
2025-11-11 12:41:01 - __main__ - INFO - Starting Epoch 31/100
2025-11-11 12:41:45 - __main__ - INFO - Starting Epoch 32/100
2025-11-11 12:42:28 - __main__ - INFO - Starting Epoch 33/100
2025-11-11 12:43:12 - __main__ - INFO - Starting Epoch 34/100
2025-11-11 12:43:56 - __main__ - INFO - Starting Epoch 35/100
2025-11-11 12:44:39 - __main__ - INFO - Starting Epoch 36/100
2025-11-11 12:45:23 - __main__ - INFO - Starting Epoch 37/100
2025-11-11 12:46:07 - __main__ - INFO - Starting Epoch 38/100
2025-11-11 12:46:51 - __main__ - INFO - Starting Epoch 39/100
2025-11-11 12:47:35 - __main__ - INFO - Starting Epoch 40/100
2025-11-11 12:48:20 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 40...
2025-11-11 12:50:12 - __main__ - INFO - Evaluation Epoch 40 (Mode: POLICY) Finished. Accuracy: 33.83% (756/2235), Avg NLL: 0.0486
2025-11-11 12:50:12 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 12:50:12 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_40_policy.csv
2025-11-11 12:50:12 - __main__ - INFO - Starting Epoch 41/100
2025-11-11 12:50:55 - __main__ - INFO - Starting Epoch 42/100
2025-11-11 12:51:39 - __main__ - INFO - Starting Epoch 43/100
2025-11-11 12:52:23 - __main__ - INFO - Starting Epoch 44/100
2025-11-11 12:53:07 - __main__ - INFO - Starting Epoch 45/100
2025-11-11 12:53:50 - __main__ - INFO - Starting Epoch 46/100
2025-11-11 12:54:51 - __main__ - INFO - Starting Epoch 47/100
2025-11-11 12:55:49 - __main__ - INFO - Starting Epoch 48/100
2025-11-11 12:56:48 - __main__ - INFO - Starting Epoch 49/100
2025-11-11 12:57:47 - __main__ - INFO - Starting Epoch 50/100
2025-11-11 12:58:47 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 50...
2025-11-11 13:00:25 - __main__ - INFO - Evaluation Epoch 50 (Mode: POLICY) Finished. Accuracy: 33.65% (752/2235), Avg NLL: 0.0491
2025-11-11 13:00:25 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 13:00:25 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_50_policy.csv
2025-11-11 13:00:25 - __main__ - INFO - Starting Epoch 51/100
2025-11-11 13:01:09 - __main__ - INFO - Starting Epoch 52/100
2025-11-11 13:01:53 - __main__ - INFO - Starting Epoch 53/100
2025-11-11 13:02:51 - __main__ - INFO - Starting Epoch 54/100
2025-11-11 13:03:50 - __main__ - INFO - Starting Epoch 55/100
2025-11-11 13:04:49 - __main__ - INFO - Starting Epoch 56/100
2025-11-11 13:05:33 - __main__ - INFO - Starting Epoch 57/100
2025-11-11 13:06:17 - __main__ - INFO - Starting Epoch 58/100
2025-11-11 13:07:01 - __main__ - INFO - Starting Epoch 59/100
2025-11-11 13:07:48 - __main__ - INFO - Starting Epoch 60/100
2025-11-11 13:08:48 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 60...
2025-11-11 13:10:40 - __main__ - INFO - Evaluation Epoch 60 (Mode: POLICY) Finished. Accuracy: 33.11% (740/2235), Avg NLL: 0.0497
2025-11-11 13:10:40 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 13:10:40 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_60_policy.csv
2025-11-11 13:10:40 - __main__ - INFO - Starting Epoch 61/100
2025-11-11 13:11:24 - __main__ - INFO - Starting Epoch 62/100
2025-11-11 13:12:08 - __main__ - INFO - Starting Epoch 63/100
2025-11-11 13:12:54 - __main__ - INFO - Starting Epoch 64/100
2025-11-11 13:13:53 - __main__ - INFO - Starting Epoch 65/100
2025-11-11 13:14:51 - __main__ - INFO - Starting Epoch 66/100
2025-11-11 13:15:35 - __main__ - INFO - Starting Epoch 67/100
2025-11-11 13:16:18 - __main__ - INFO - Starting Epoch 68/100
2025-11-11 13:17:01 - __main__ - INFO - Starting Epoch 69/100
2025-11-11 13:17:45 - __main__ - INFO - Starting Epoch 70/100
2025-11-11 13:18:28 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 70...
2025-11-11 13:20:12 - __main__ - INFO - Evaluation Epoch 70 (Mode: POLICY) Finished. Accuracy: 33.69% (753/2235), Avg NLL: 0.0484
2025-11-11 13:20:12 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 13:20:12 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_70_policy.csv
2025-11-11 13:20:12 - __main__ - INFO - Starting Epoch 71/100
2025-11-11 13:20:56 - __main__ - INFO - Starting Epoch 72/100
2025-11-11 13:21:42 - __main__ - INFO - Starting Epoch 73/100
2025-11-11 13:22:40 - __main__ - INFO - Starting Epoch 74/100
2025-11-11 13:23:38 - __main__ - INFO - Starting Epoch 75/100
2025-11-11 13:24:36 - __main__ - INFO - Starting Epoch 76/100
2025-11-11 13:25:35 - __main__ - INFO - Starting Epoch 77/100
2025-11-11 13:26:33 - __main__ - INFO - Starting Epoch 78/100
2025-11-11 13:27:31 - __main__ - INFO - Starting Epoch 79/100
2025-11-11 13:28:29 - __main__ - INFO - Starting Epoch 80/100
2025-11-11 13:29:28 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 80...
2025-11-11 13:30:59 - __main__ - INFO - Evaluation Epoch 80 (Mode: POLICY) Finished. Accuracy: 31.81% (711/2235), Avg NLL: 0.0511
2025-11-11 13:30:59 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 13:30:59 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_80_policy.csv
2025-11-11 13:30:59 - __main__ - INFO - Starting Epoch 81/100
2025-11-11 13:31:43 - __main__ - INFO - Starting Epoch 82/100
2025-11-11 13:32:28 - __main__ - INFO - Starting Epoch 83/100
2025-11-11 13:33:27 - __main__ - INFO - Starting Epoch 84/100
2025-11-11 13:34:25 - __main__ - INFO - Starting Epoch 85/100
2025-11-11 13:35:23 - __main__ - INFO - Starting Epoch 86/100
2025-11-11 13:36:22 - __main__ - INFO - Starting Epoch 87/100
2025-11-11 13:37:05 - __main__ - INFO - Starting Epoch 88/100
2025-11-11 13:38:03 - __main__ - INFO - Starting Epoch 89/100
2025-11-11 13:39:00 - __main__ - INFO - Starting Epoch 90/100
2025-11-11 13:39:58 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 90...
2025-11-11 13:41:35 - __main__ - INFO - Evaluation Epoch 90 (Mode: POLICY) Finished. Accuracy: 33.38% (746/2235), Avg NLL: 0.0489
2025-11-11 13:41:35 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 13:41:35 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_90_policy.csv
2025-11-11 13:41:35 - __main__ - INFO - Starting Epoch 91/100
2025-11-11 13:42:19 - __main__ - INFO - Starting Epoch 92/100
2025-11-11 13:43:04 - __main__ - INFO - Starting Epoch 93/100
2025-11-11 13:43:48 - __main__ - INFO - Starting Epoch 94/100
2025-11-11 13:44:41 - __main__ - INFO - Starting Epoch 95/100
2025-11-11 13:45:23 - __main__ - INFO - Starting Epoch 96/100
2025-11-11 13:46:07 - __main__ - INFO - Starting Epoch 97/100
2025-11-11 13:46:51 - __main__ - INFO - Starting Epoch 98/100
2025-11-11 13:47:34 - __main__ - INFO - Starting Epoch 99/100
2025-11-11 13:48:17 - __main__ - INFO - Starting Epoch 100/100
2025-11-11 13:49:01 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 100...
2025-11-11 13:50:46 - __main__ - INFO - Evaluation Epoch 100 (Mode: POLICY) Finished. Accuracy: 33.87% (757/2235), Avg NLL: 0.0506
2025-11-11 13:50:46 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 13:50:46 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_100_policy.csv
2025-11-11 13:50:46 - __main__ - INFO - --- Final evaluation after all epochs ---
2025-11-11 13:50:46 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch final...
2025-11-11 13:52:25 - __main__ - INFO - Evaluation Epoch final (Mode: POLICY) Finished. Accuracy: 33.51% (749/2235), Avg NLL: 0.0497
2025-11-11 13:52:25 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 13:52:25 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1211_epoch_final_policy.csv
2025-11-11 13:52:25 - __main__ - INFO - Final post-training evaluation accuracy: 33.51%
2025-11-11 13:52:25 - __main__ - INFO - --- Training Finished ---
2025-11-11 13:52:25 - __main__ - INFO - Best validation accuracy: 34.32%
