2025-11-11 15:42:39 - root - INFO - Logging setup complete. Outputting to console and file: logs/1111_1542.log
2025-11-11 15:42:39 - root - INFO - Initialized all random seeds to: 42
2025-11-11 15:42:39 - __main__ - INFO - Using device: cuda
2025-11-11 15:42:39 - __main__ - INFO - Starting run: 1111_1542
2025-11-11 15:42:39 - __main__ - INFO - --- Initializing Models ---
2025-11-11 15:42:39 - root - INFO - [EmbeddingModel] Loading embedding model: all-MiniLM-L6-v2...
2025-11-11 15:42:39 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-11-11 15:42:46 - root - INFO - [EmbeddingModel] Model loaded. Embedding dimension: 384
2025-11-11 15:42:46 - models.llm_wrapper - INFO - Loading LLM environment: Qwen/Qwen3-8B...
2025-11-11 15:42:52 - models.llm_wrapper - INFO - LLM 'Qwen/Qwen3-8B' loaded successfully.
2025-11-11 15:42:52 - models.policy_network - INFO - Initializing PolicyNetwork (Type: LSTM)
2025-11-11 15:42:53 - __main__ - INFO - Successfully loaded pre-trained MMR weights from: checkpoints/pretrain/mtop_pretrained.pt
2025-11-11 15:42:53 - __main__ - INFO - --- Loading Data ---
2025-11-11 15:42:53 - data_utils.mtop_loader - INFO - --- Creating Corpus (Action Space) ---
2025-11-11 15:42:53 - data_utils.mtop_loader - INFO - Loading full 'train' split (no global cache used)...
2025-11-11 15:42:58 - data_utils.mtop_loader - INFO - Loading EmbeddingModel (all-MiniLM-L6-v2) for K-Means/Sampling...
2025-11-11 15:42:58 - root - INFO - [EmbeddingModel] Loading embedding model: all-MiniLM-L6-v2...
2025-11-11 15:42:58 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-11-11 15:43:04 - root - INFO - [EmbeddingModel] Model loaded. Embedding dimension: 384
2025-11-11 15:43:04 - data_utils.mtop_loader - INFO - Pre-computing all training data embeddings...
2025-11-11 15:43:05 - data_utils.mtop_loader - INFO - Full train data and embeddings loaded (15667 samples).
2025-11-11 15:43:05 - data_utils.mtop_loader - WARNING - USE_CLUSTERED_CORPUS=False. Using the *entire* training dataset (15667 samples) as corpus.
2025-11-11 15:43:05 - data_utils.mtop_loader - INFO - Corpus created. Final size: 15667
2025-11-11 15:43:05 - __main__ - INFO - Corpus embeddings computed. Shape: torch.Size([15667, 384])
2025-11-11 15:43:05 - data_utils.mtop_loader - INFO - Loading query dataloader (split=train, batch_size=16, shuffle=True)...
2025-11-11 15:43:05 - data_utils.mtop_loader - INFO - Loading 'train' split data from Hugging Face...
2025-11-11 15:43:09 - data_utils.mtop_loader - INFO - Randomly sampling 5000 examples for 'train' split...
2025-11-11 15:43:09 - data_utils.mtop_loader - INFO - Loading query dataloader (split=dev, batch_size=64, shuffle=False)...
2025-11-11 15:43:13 - __main__ - INFO - --- Initializing PPO Components ---
2025-11-11 15:43:13 - engine.sampler - INFO - EpisodeSampler initialized for 4 steps.
2025-11-11 15:43:13 - engine.reward_computer - INFO - RewardComputer initialized with GAE (gamma=0.99, lambda=0.95)
2025-11-11 15:43:13 - __main__ - INFO - --- Starting Training Loop ---
2025-11-11 15:43:13 - __main__ - INFO - --- Running Initial kNN Baseline Evaluation ---
2025-11-11 15:43:13 - __main__ - INFO - --- kNN Baseline Evaluation Finished ---
2025-11-11 15:43:13 - __main__ - INFO - Starting Epoch 1/100
2025-11-11 15:48:05 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 1...
2025-11-11 15:52:39 - __main__ - INFO - Evaluation Epoch 1 (Mode: POLICY) Finished. Accuracy: 41.30% (923/2235), Avg NLL: 0.0125
2025-11-11 15:52:39 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 15:52:39 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_1_policy.csv
2025-11-11 15:52:39 - __main__ - INFO - New best validation accuracy: 41.30%! Saving model...
2025-11-11 15:52:39 - __main__ - INFO - Starting Epoch 2/100
2025-11-11 15:57:34 - __main__ - INFO - Starting Epoch 3/100
2025-11-11 16:02:29 - __main__ - INFO - Starting Epoch 4/100
2025-11-11 16:07:26 - __main__ - INFO - Starting Epoch 5/100
2025-11-11 16:12:21 - __main__ - INFO - Starting Epoch 6/100
2025-11-11 16:17:15 - __main__ - INFO - Starting Epoch 7/100
2025-11-11 16:22:09 - __main__ - INFO - Starting Epoch 8/100
2025-11-11 16:27:06 - __main__ - INFO - Starting Epoch 9/100
2025-11-11 16:31:59 - __main__ - INFO - Starting Epoch 10/100
2025-11-11 16:36:53 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 10...
2025-11-11 16:41:16 - __main__ - INFO - Evaluation Epoch 10 (Mode: POLICY) Finished. Accuracy: 42.01% (939/2235), Avg NLL: 0.0129
2025-11-11 16:41:16 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 16:41:16 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_10_policy.csv
2025-11-11 16:41:16 - __main__ - INFO - New best validation accuracy: 42.01%! Saving model...
2025-11-11 16:41:16 - __main__ - INFO - Starting Epoch 11/100
2025-11-11 16:46:16 - __main__ - INFO - Starting Epoch 12/100
2025-11-11 16:51:15 - __main__ - INFO - Starting Epoch 13/100
2025-11-11 16:56:10 - __main__ - INFO - Starting Epoch 14/100
2025-11-11 17:01:07 - __main__ - INFO - Starting Epoch 15/100
2025-11-11 17:06:03 - __main__ - INFO - Starting Epoch 16/100
2025-11-11 17:11:00 - __main__ - INFO - Starting Epoch 17/100
2025-11-11 17:15:55 - __main__ - INFO - Starting Epoch 18/100
2025-11-11 17:20:53 - __main__ - INFO - Starting Epoch 19/100
2025-11-11 17:25:48 - __main__ - INFO - Starting Epoch 20/100
2025-11-11 17:30:44 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 20...
2025-11-11 17:35:15 - __main__ - INFO - Evaluation Epoch 20 (Mode: POLICY) Finished. Accuracy: 42.46% (949/2235), Avg NLL: 0.0119
2025-11-11 17:35:15 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 17:35:15 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_20_policy.csv
2025-11-11 17:35:15 - __main__ - INFO - New best validation accuracy: 42.46%! Saving model...
2025-11-11 17:35:15 - __main__ - INFO - Starting Epoch 21/100
2025-11-11 17:40:13 - __main__ - INFO - Starting Epoch 22/100
2025-11-11 17:45:07 - __main__ - INFO - Starting Epoch 23/100
2025-11-11 17:50:04 - __main__ - INFO - Starting Epoch 24/100
2025-11-11 17:55:04 - __main__ - INFO - Starting Epoch 25/100
2025-11-11 18:00:00 - __main__ - INFO - Starting Epoch 26/100
2025-11-11 18:04:59 - __main__ - INFO - Starting Epoch 27/100
2025-11-11 18:09:53 - __main__ - INFO - Starting Epoch 28/100
2025-11-11 18:14:50 - __main__ - INFO - Starting Epoch 29/100
2025-11-11 18:19:48 - __main__ - INFO - Starting Epoch 30/100
2025-11-11 18:24:45 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 30...
2025-11-11 18:29:30 - __main__ - INFO - Evaluation Epoch 30 (Mode: POLICY) Finished. Accuracy: 41.66% (931/2235), Avg NLL: 0.0126
2025-11-11 18:29:30 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 18:29:30 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_30_policy.csv
2025-11-11 18:29:30 - __main__ - INFO - Starting Epoch 31/100
2025-11-11 18:34:25 - __main__ - INFO - Starting Epoch 32/100
2025-11-11 18:39:18 - __main__ - INFO - Starting Epoch 33/100
2025-11-11 18:44:13 - __main__ - INFO - Starting Epoch 34/100
2025-11-11 18:49:08 - __main__ - INFO - Starting Epoch 35/100
2025-11-11 18:54:04 - __main__ - INFO - Starting Epoch 36/100
2025-11-11 18:59:00 - __main__ - INFO - Starting Epoch 37/100
2025-11-11 19:03:58 - __main__ - INFO - Starting Epoch 38/100
2025-11-11 19:08:58 - __main__ - INFO - Starting Epoch 39/100
2025-11-11 19:14:00 - __main__ - INFO - Starting Epoch 40/100
2025-11-11 19:18:56 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 40...
2025-11-11 19:23:44 - __main__ - INFO - Evaluation Epoch 40 (Mode: POLICY) Finished. Accuracy: 41.79% (934/2235), Avg NLL: 0.0116
2025-11-11 19:23:44 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 19:23:44 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_40_policy.csv
2025-11-11 19:23:44 - __main__ - INFO - Starting Epoch 41/100
2025-11-11 19:28:38 - __main__ - INFO - Starting Epoch 42/100
2025-11-11 19:33:33 - __main__ - INFO - Starting Epoch 43/100
2025-11-11 19:38:29 - __main__ - INFO - Starting Epoch 44/100
2025-11-11 19:43:28 - __main__ - INFO - Starting Epoch 45/100
2025-11-11 19:48:27 - __main__ - INFO - Starting Epoch 46/100
2025-11-11 19:53:27 - __main__ - INFO - Starting Epoch 47/100
2025-11-11 19:58:22 - __main__ - INFO - Starting Epoch 48/100
2025-11-11 20:03:23 - __main__ - INFO - Starting Epoch 49/100
2025-11-11 20:08:18 - __main__ - INFO - Starting Epoch 50/100
2025-11-11 20:13:13 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 50...
2025-11-11 20:17:39 - __main__ - INFO - Evaluation Epoch 50 (Mode: POLICY) Finished. Accuracy: 41.03% (917/2235), Avg NLL: 0.0126
2025-11-11 20:17:39 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 20:17:39 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_50_policy.csv
2025-11-11 20:17:39 - __main__ - INFO - Starting Epoch 51/100
2025-11-11 20:22:35 - __main__ - INFO - Starting Epoch 52/100
2025-11-11 20:27:30 - __main__ - INFO - Starting Epoch 53/100
2025-11-11 20:32:26 - __main__ - INFO - Starting Epoch 54/100
2025-11-11 20:37:22 - __main__ - INFO - Starting Epoch 55/100
2025-11-11 20:42:19 - __main__ - INFO - Starting Epoch 56/100
2025-11-11 20:47:15 - __main__ - INFO - Starting Epoch 57/100
2025-11-11 20:52:13 - __main__ - INFO - Starting Epoch 58/100
2025-11-11 20:57:06 - __main__ - INFO - Starting Epoch 59/100
2025-11-11 21:02:03 - __main__ - INFO - Starting Epoch 60/100
2025-11-11 21:07:01 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 60...
2025-11-11 21:11:20 - __main__ - INFO - Evaluation Epoch 60 (Mode: POLICY) Finished. Accuracy: 42.01% (939/2235), Avg NLL: 0.0125
2025-11-11 21:11:20 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 21:11:20 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_60_policy.csv
2025-11-11 21:11:20 - __main__ - INFO - Starting Epoch 61/100
2025-11-11 21:16:15 - __main__ - INFO - Starting Epoch 62/100
2025-11-11 21:21:10 - __main__ - INFO - Starting Epoch 63/100
2025-11-11 21:26:07 - __main__ - INFO - Starting Epoch 64/100
2025-11-11 21:31:05 - __main__ - INFO - Starting Epoch 65/100
2025-11-11 21:36:01 - __main__ - INFO - Starting Epoch 66/100
2025-11-11 21:40:55 - __main__ - INFO - Starting Epoch 67/100
2025-11-11 21:45:50 - __main__ - INFO - Starting Epoch 68/100
2025-11-11 21:50:46 - __main__ - INFO - Starting Epoch 69/100
2025-11-11 21:55:42 - __main__ - INFO - Starting Epoch 70/100
2025-11-11 22:00:37 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 70...
2025-11-11 22:05:01 - __main__ - INFO - Evaluation Epoch 70 (Mode: POLICY) Finished. Accuracy: 42.46% (949/2235), Avg NLL: 0.0119
2025-11-11 22:05:01 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 22:05:01 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_70_policy.csv
2025-11-11 22:05:01 - __main__ - INFO - Starting Epoch 71/100
2025-11-11 22:09:57 - __main__ - INFO - Starting Epoch 72/100
2025-11-11 22:14:54 - __main__ - INFO - Starting Epoch 73/100
2025-11-11 22:19:49 - __main__ - INFO - Starting Epoch 74/100
2025-11-11 22:24:42 - __main__ - INFO - Starting Epoch 75/100
2025-11-11 22:29:35 - __main__ - INFO - Starting Epoch 76/100
2025-11-11 22:34:29 - __main__ - INFO - Starting Epoch 77/100
2025-11-11 22:39:24 - __main__ - INFO - Starting Epoch 78/100
2025-11-11 22:44:19 - __main__ - INFO - Starting Epoch 79/100
2025-11-11 22:49:15 - __main__ - INFO - Starting Epoch 80/100
2025-11-11 22:54:13 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 80...
2025-11-11 22:58:50 - __main__ - INFO - Evaluation Epoch 80 (Mode: POLICY) Finished. Accuracy: 41.25% (922/2235), Avg NLL: 0.0123
2025-11-11 22:58:50 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 22:58:50 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_80_policy.csv
2025-11-11 22:58:50 - __main__ - INFO - Starting Epoch 81/100
2025-11-11 23:03:45 - __main__ - INFO - Starting Epoch 82/100
2025-11-11 23:08:41 - __main__ - INFO - Starting Epoch 83/100
2025-11-11 23:13:38 - __main__ - INFO - Starting Epoch 84/100
2025-11-11 23:18:36 - __main__ - INFO - Starting Epoch 85/100
2025-11-11 23:23:31 - __main__ - INFO - Starting Epoch 86/100
2025-11-11 23:28:25 - __main__ - INFO - Starting Epoch 87/100
2025-11-11 23:33:20 - __main__ - INFO - Starting Epoch 88/100
2025-11-11 23:38:15 - __main__ - INFO - Starting Epoch 89/100
2025-11-11 23:43:11 - __main__ - INFO - Starting Epoch 90/100
2025-11-11 23:48:07 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 90...
2025-11-11 23:52:31 - __main__ - INFO - Evaluation Epoch 90 (Mode: POLICY) Finished. Accuracy: 41.52% (928/2235), Avg NLL: 0.0118
2025-11-11 23:52:31 - __main__ - INFO - Saving evaluation results to file...
2025-11-11 23:52:31 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_90_policy.csv
2025-11-11 23:52:31 - __main__ - INFO - Starting Epoch 91/100
2025-11-11 23:57:27 - __main__ - INFO - Starting Epoch 92/100
2025-11-12 00:02:24 - __main__ - INFO - Starting Epoch 93/100
2025-11-12 00:07:18 - __main__ - INFO - Starting Epoch 94/100
2025-11-12 00:12:11 - __main__ - INFO - Starting Epoch 95/100
2025-11-12 00:17:05 - __main__ - INFO - Starting Epoch 96/100
2025-11-12 00:22:04 - __main__ - INFO - Starting Epoch 97/100
2025-11-12 00:27:02 - __main__ - INFO - Starting Epoch 98/100
2025-11-12 00:31:59 - __main__ - INFO - Starting Epoch 99/100
2025-11-12 00:36:55 - __main__ - INFO - Starting Epoch 100/100
2025-11-12 00:41:51 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch 100...
2025-11-12 00:46:34 - __main__ - INFO - Evaluation Epoch 100 (Mode: POLICY) Finished. Accuracy: 41.70% (932/2235), Avg NLL: 0.0120
2025-11-12 00:46:34 - __main__ - INFO - Saving evaluation results to file...
2025-11-12 00:46:34 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_100_policy.csv
2025-11-12 00:46:34 - __main__ - INFO - --- Final evaluation after all epochs ---
2025-11-12 00:46:34 - __main__ - INFO - Starting evaluation (Mode: POLICY) for Epoch final...
2025-11-12 00:51:08 - __main__ - INFO - Evaluation Epoch final (Mode: POLICY) Finished. Accuracy: 42.51% (950/2235), Avg NLL: 0.0122
2025-11-12 00:51:08 - __main__ - INFO - Saving evaluation results to file...
2025-11-12 00:51:08 - __main__ - INFO - Evaluation results saved to: outputs/val_results_1111_1542_epoch_final_policy.csv
2025-11-12 00:51:08 - __main__ - INFO - Final post-training evaluation accuracy: 42.51%
2025-11-12 00:51:08 - __main__ - INFO - New best validation accuracy: 42.51%! Saving model...
2025-11-12 00:51:08 - __main__ - INFO - --- Training Finished ---
2025-11-12 00:51:08 - __main__ - INFO - Best validation accuracy: 42.51%
