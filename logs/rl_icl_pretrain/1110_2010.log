2025-11-10 20:10:45 - root - INFO - Logging setup complete. Outputting to console and file: logs/rl_icl_pretrain/1110_2010.log
2025-11-10 20:10:45 - root - INFO - Initialized all random seeds to: 42
2025-11-10 20:10:45 - __main__ - INFO - Using device: cuda
2025-11-10 20:10:45 - __main__ - INFO - --- Loading Models & Data for Pre-training ---
2025-11-10 20:10:45 - root - INFO - [EmbeddingModel] Loading embedding model: all-MiniLM-L6-v2...
2025-11-10 20:10:45 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-11-10 20:10:53 - root - INFO - [EmbeddingModel] Model loaded. Embedding dimension: 384
2025-11-10 20:10:53 - models.llm_wrapper - INFO - Loading LLM environment: Qwen/Qwen3-0.6B...
2025-11-10 20:10:56 - models.llm_wrapper - INFO - LLM 'Qwen/Qwen3-0.6B' loaded successfully.
2025-11-10 20:10:56 - models.policy_network - INFO - Initializing PolicyNetwork (Type: LSTM)
2025-11-10 20:10:56 - data_utils.mtop_loader - INFO - --- Creating Corpus (Action Space) ---
2025-11-10 20:10:56 - data_utils.mtop_loader - INFO - Loading full 'train' split (no global cache used)...
2025-11-10 20:11:05 - data_utils.mtop_loader - INFO - Loading EmbeddingModel (all-MiniLM-L6-v2) for K-Means/Sampling...
2025-11-10 20:11:05 - root - INFO - [EmbeddingModel] Loading embedding model: all-MiniLM-L6-v2...
2025-11-10 20:11:05 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-11-10 20:11:13 - root - INFO - [EmbeddingModel] Model loaded. Embedding dimension: 384
2025-11-10 20:11:13 - data_utils.mtop_loader - INFO - Pre-computing all training data embeddings...
2025-11-10 20:11:16 - data_utils.mtop_loader - INFO - Full train data and embeddings loaded (15667 samples).
2025-11-10 20:11:16 - data_utils.mtop_loader - WARNING - USE_CLUSTERED_CORPUS=False. Using the *entire* training dataset (15667 samples) as corpus.
2025-11-10 20:11:16 - data_utils.mtop_loader - INFO - Corpus created. Final size: 15667
2025-11-10 20:11:16 - __main__ - INFO - Corpus loaded. Size: 15667, Embeddings shape: torch.Size([15667, 384])
2025-11-10 20:11:16 - __main__ - INFO - Loading 'dev' split for MMR evaluation...
2025-11-10 20:11:16 - data_utils.mtop_loader - INFO - Loading query dataloader (split=dev, batch_size=32, shuffle=False)...
2025-11-10 20:11:24 - __main__ - INFO - --- Running MMR Expert Baseline Evaluation ---
2025-11-10 20:11:24 - __main__ - INFO - Starting evaluation (Mode: mmr)...
2025-11-10 20:13:22 - __main__ - INFO - Evaluation Pretrain (Mode: mmr) Finished. Accuracy: 36.38% (813/2235), Avg NLL: 0.0488
2025-11-10 20:13:22 - __main__ - INFO - Saving evaluation results to file...
2025-11-10 20:13:22 - __main__ - INFO - Evaluation results saved to: 1110_2010/eval_results/val_results_pretrain_mmr.csv
2025-11-10 20:13:22 - __main__ - INFO - --- MMR Expert Baseline Evaluation Finished ---
2025-11-10 20:13:22 - data_utils.mtop_loader - INFO - Loading query dataloader (split=train, batch_size=32, shuffle=False)...
2025-11-10 20:13:22 - data_utils.mtop_loader - INFO - Loading 'train' split data from Hugging Face...
2025-11-10 20:13:26 - data_utils.mtop_loader - INFO - Randomly sampling 5000 examples for 'train' split...
2025-11-10 20:13:26 - __main__ - INFO - --- Generating MMR Expert Trajectories ---
2025-11-10 20:13:28 - __main__ - INFO - Generated 5000 MMR trajectories.
2025-11-10 20:13:28 - engine.reward_computer - INFO - RewardComputer initialized with GAE (gamma=0.99, lambda=0.95)
2025-11-10 20:13:28 - __main__ - INFO - --- Computing Expert Returns for MMR Trajectories ---
2025-11-10 20:14:10 - __main__ - INFO - --- Starting Supervised Pre-training ---
2025-11-10 20:14:10 - __main__ - INFO - Target Actor Loss: 0.2
2025-11-10 20:14:10 - __main__ - INFO - Max Epochs: 1000
2025-11-10 20:14:11 - __main__ - INFO - Pre-train Epoch 1 finished. Avg Actor Loss: 9.5985, Avg Critic Loss: 6.1332
2025-11-10 20:14:11 - __main__ - INFO - Pre-train Epoch 2 finished. Avg Actor Loss: 9.2738, Avg Critic Loss: 5.2232
2025-11-10 20:14:12 - __main__ - INFO - Pre-train Epoch 3 finished. Avg Actor Loss: 9.1012, Avg Critic Loss: 4.8317
2025-11-10 20:14:12 - __main__ - INFO - Pre-train Epoch 4 finished. Avg Actor Loss: 8.9676, Avg Critic Loss: 4.6204
2025-11-10 20:14:13 - __main__ - INFO - Pre-train Epoch 5 finished. Avg Actor Loss: 8.8886, Avg Critic Loss: 4.4945
2025-11-10 20:14:13 - __main__ - INFO - Pre-train Epoch 6 finished. Avg Actor Loss: 8.8256, Avg Critic Loss: 4.4290
2025-11-10 20:14:14 - __main__ - INFO - Pre-train Epoch 7 finished. Avg Actor Loss: 8.7718, Avg Critic Loss: 4.4015
2025-11-10 20:14:14 - __main__ - INFO - Pre-train Epoch 8 finished. Avg Actor Loss: 8.7238, Avg Critic Loss: 4.3868
2025-11-10 20:14:15 - __main__ - INFO - Pre-train Epoch 9 finished. Avg Actor Loss: 8.6799, Avg Critic Loss: 4.3099
2025-11-10 20:14:15 - __main__ - INFO - Pre-train Epoch 10 finished. Avg Actor Loss: 8.6344, Avg Critic Loss: 4.3025
2025-11-10 20:14:16 - __main__ - INFO - Pre-train Epoch 11 finished. Avg Actor Loss: 8.5892, Avg Critic Loss: 4.2661
2025-11-10 20:14:16 - __main__ - INFO - Pre-train Epoch 12 finished. Avg Actor Loss: 8.5499, Avg Critic Loss: 4.2660
2025-11-10 20:14:16 - __main__ - INFO - Pre-train Epoch 13 finished. Avg Actor Loss: 8.5057, Avg Critic Loss: 4.2304
2025-11-10 20:14:17 - __main__ - INFO - Pre-train Epoch 14 finished. Avg Actor Loss: 8.4619, Avg Critic Loss: 4.2045
2025-11-10 20:14:17 - __main__ - INFO - Pre-train Epoch 15 finished. Avg Actor Loss: 8.4194, Avg Critic Loss: 4.2096
2025-11-10 20:14:18 - __main__ - INFO - Pre-train Epoch 16 finished. Avg Actor Loss: 8.3767, Avg Critic Loss: 4.1754
2025-11-10 20:14:18 - __main__ - INFO - Pre-train Epoch 17 finished. Avg Actor Loss: 8.3408, Avg Critic Loss: 4.1532
2025-11-10 20:14:19 - __main__ - INFO - Pre-train Epoch 18 finished. Avg Actor Loss: 8.3000, Avg Critic Loss: 4.1306
2025-11-10 20:14:19 - __main__ - INFO - Pre-train Epoch 19 finished. Avg Actor Loss: 8.2611, Avg Critic Loss: 4.1114
2025-11-10 20:14:20 - __main__ - INFO - Pre-train Epoch 20 finished. Avg Actor Loss: 8.2285, Avg Critic Loss: 4.1055
2025-11-10 20:14:20 - __main__ - INFO - Pre-train Epoch 21 finished. Avg Actor Loss: 8.1915, Avg Critic Loss: 4.0823
2025-11-10 20:14:20 - __main__ - INFO - Pre-train Epoch 22 finished. Avg Actor Loss: 8.1500, Avg Critic Loss: 4.0735
2025-11-10 20:14:21 - __main__ - INFO - Pre-train Epoch 23 finished. Avg Actor Loss: 8.1138, Avg Critic Loss: 4.0888
2025-11-10 20:14:21 - __main__ - INFO - Pre-train Epoch 24 finished. Avg Actor Loss: 8.0781, Avg Critic Loss: 4.0309
2025-11-10 20:14:22 - __main__ - INFO - Pre-train Epoch 25 finished. Avg Actor Loss: 8.0455, Avg Critic Loss: 4.0032
2025-11-10 20:14:22 - __main__ - INFO - Pre-train Epoch 26 finished. Avg Actor Loss: 8.0130, Avg Critic Loss: 4.0004
2025-11-10 20:14:23 - __main__ - INFO - Pre-train Epoch 27 finished. Avg Actor Loss: 7.9795, Avg Critic Loss: 3.9863
2025-11-10 20:14:23 - __main__ - INFO - Pre-train Epoch 28 finished. Avg Actor Loss: 7.9430, Avg Critic Loss: 3.9590
2025-11-10 20:14:24 - __main__ - INFO - Pre-train Epoch 29 finished. Avg Actor Loss: 7.9162, Avg Critic Loss: 3.9740
2025-11-10 20:14:24 - __main__ - INFO - Pre-train Epoch 30 finished. Avg Actor Loss: 7.8831, Avg Critic Loss: 4.0085
2025-11-10 20:14:24 - __main__ - INFO - Pre-train Epoch 31 finished. Avg Actor Loss: 7.8561, Avg Critic Loss: 3.9405
2025-11-10 20:14:25 - __main__ - INFO - Pre-train Epoch 32 finished. Avg Actor Loss: 7.8220, Avg Critic Loss: 3.9454
2025-11-10 20:14:25 - __main__ - INFO - Pre-train Epoch 33 finished. Avg Actor Loss: 7.7947, Avg Critic Loss: 3.9026
2025-11-10 20:14:26 - __main__ - INFO - Pre-train Epoch 34 finished. Avg Actor Loss: 7.7689, Avg Critic Loss: 3.8785
2025-11-10 20:14:26 - __main__ - INFO - Pre-train Epoch 35 finished. Avg Actor Loss: 7.7420, Avg Critic Loss: 3.8743
2025-11-10 20:14:27 - __main__ - INFO - Pre-train Epoch 36 finished. Avg Actor Loss: 7.7146, Avg Critic Loss: 3.8590
2025-11-10 20:14:27 - __main__ - INFO - Pre-train Epoch 37 finished. Avg Actor Loss: 7.6861, Avg Critic Loss: 3.8255
2025-11-10 20:14:28 - __main__ - INFO - Pre-train Epoch 38 finished. Avg Actor Loss: 7.6644, Avg Critic Loss: 3.8571
2025-11-10 20:14:28 - __main__ - INFO - Pre-train Epoch 39 finished. Avg Actor Loss: 7.6326, Avg Critic Loss: 3.7960
2025-11-10 20:14:28 - __main__ - INFO - Pre-train Epoch 40 finished. Avg Actor Loss: 7.6103, Avg Critic Loss: 3.8026
2025-11-10 20:14:29 - __main__ - INFO - Pre-train Epoch 41 finished. Avg Actor Loss: 7.5811, Avg Critic Loss: 3.7617
2025-11-10 20:14:29 - __main__ - INFO - Pre-train Epoch 42 finished. Avg Actor Loss: 7.5620, Avg Critic Loss: 3.7580
2025-11-10 20:14:30 - __main__ - INFO - Pre-train Epoch 43 finished. Avg Actor Loss: 7.5365, Avg Critic Loss: 3.7354
2025-11-10 20:14:30 - __main__ - INFO - Pre-train Epoch 44 finished. Avg Actor Loss: 7.5093, Avg Critic Loss: 3.7132
2025-11-10 20:14:31 - __main__ - INFO - Pre-train Epoch 45 finished. Avg Actor Loss: 7.4940, Avg Critic Loss: 3.7221
2025-11-10 20:14:31 - __main__ - INFO - Pre-train Epoch 46 finished. Avg Actor Loss: 7.4695, Avg Critic Loss: 3.6817
2025-11-10 20:14:32 - __main__ - INFO - Pre-train Epoch 47 finished. Avg Actor Loss: 7.4449, Avg Critic Loss: 3.7255
