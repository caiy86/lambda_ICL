2025-11-13 15:08:00 - root - INFO - Logging setup complete. Outputting to console and file: logs/rl_icl_qwen_8b_test1113_1507.log
2025-11-13 15:08:00 - root - INFO - Initialized all random seeds to: 42
2025-11-13 15:08:00 - __main__ - INFO - Using device: cuda
2025-11-13 15:08:00 - __main__ - INFO - Starting run: 1113_1507
2025-11-13 15:08:00 - __main__ - INFO - --- Initializing Models ---
2025-11-13 15:08:00 - root - INFO - [EmbeddingModel] Loading embedding model: all-MiniLM-L6-v2...
2025-11-13 15:08:00 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-11-13 15:08:06 - root - INFO - [EmbeddingModel] Model loaded. Embedding dimension: 384
2025-11-13 15:08:06 - models.llm_wrapper - INFO - Loading LLM environment: Qwen/Qwen3-8B...
2025-11-13 15:08:10 - accelerate.big_modeling - WARNING - Some parameters are on the meta device because they were offloaded to the cpu.
2025-11-13 15:08:11 - models.llm_wrapper - INFO - LLM 'Qwen/Qwen3-8B' loaded successfully.
2025-11-13 15:08:11 - data_utils.mtop_loader - INFO - --- Creating Corpus (Action Space) ---
2025-11-13 15:08:11 - data_utils.mtop_loader - INFO - Loading full 'train' split (no global cache used)...
2025-11-13 15:08:17 - data_utils.mtop_loader - INFO - Loading EmbeddingModel (all-MiniLM-L6-v2) for K-Means/Sampling...
2025-11-13 15:08:17 - root - INFO - [EmbeddingModel] Loading embedding model: all-MiniLM-L6-v2...
2025-11-13 15:08:17 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-11-13 15:08:23 - root - INFO - [EmbeddingModel] Model loaded. Embedding dimension: 384
2025-11-13 15:08:23 - data_utils.mtop_loader - INFO - Pre-computing all training data embeddings...
2025-11-13 15:08:24 - data_utils.mtop_loader - INFO - Full train data and embeddings loaded (15667 samples).
2025-11-13 15:08:24 - data_utils.mtop_loader - WARNING - USE_CLUSTERED_CORPUS=False. Using the *entire* training dataset (15667 samples) as corpus.
2025-11-13 15:08:24 - data_utils.mtop_loader - INFO - Corpus created. Final size: 15667
2025-11-13 15:08:24 - __main__ - INFO - Corpus embeddings computed. Shape: torch.Size([15667, 384])
2025-11-13 15:08:24 - data_utils.mtop_loader - INFO - Loading query dataloader (split=train, batch_size=16, shuffle=True, nums=5000)...
2025-11-13 15:08:28 - data_utils.mtop_loader - INFO - Randomly sampling 5000 examples for 'train' split...
2025-11-13 15:08:28 - data_utils.mtop_loader - INFO - Loading query dataloader (split=dev, batch_size=64, shuffle=False, nums=128)...
2025-11-13 15:08:32 - data_utils.mtop_loader - INFO - Randomly sampling 128 examples for 'dev' split...
2025-11-13 15:08:32 - root - INFO - this valuation the mmr lambda = 0.6
2025-11-13 15:11:13 - __main__ - INFO - Accuracy: 57.03% (73/128), Avg NLL: 0.0030
2025-11-13 15:11:13 - __main__ - INFO - Saving evaluation results to file...
2025-11-13 15:11:13 - __main__ - INFO - Evaluation results saved to: results/rl_icl_qwen_8b_test/1113_1507/val_results_test.csv
2025-11-13 15:11:13 - root - INFO - this valuation the mmr lambda = 0.7
2025-11-13 15:13:57 - __main__ - INFO - Accuracy: 63.28% (81/128), Avg NLL: 0.0029
2025-11-13 15:13:57 - __main__ - INFO - Saving evaluation results to file...
2025-11-13 15:13:57 - __main__ - INFO - Evaluation results saved to: results/rl_icl_qwen_8b_test/1113_1507/val_results_test.csv
2025-11-13 15:13:57 - root - INFO - this valuation the mmr lambda = 0.8
2025-11-13 15:16:34 - __main__ - INFO - Accuracy: 62.50% (80/128), Avg NLL: 0.0035
2025-11-13 15:16:34 - __main__ - INFO - Saving evaluation results to file...
2025-11-13 15:16:34 - __main__ - INFO - Evaluation results saved to: results/rl_icl_qwen_8b_test/1113_1507/val_results_test.csv
2025-11-13 15:16:34 - root - INFO - this valuation the mmr lambda = 0.9
2025-11-13 15:19:19 - __main__ - INFO - Accuracy: 54.69% (70/128), Avg NLL: 0.0031
2025-11-13 15:19:19 - __main__ - INFO - Saving evaluation results to file...
2025-11-13 15:19:19 - __main__ - INFO - Evaluation results saved to: results/rl_icl_qwen_8b_test/1113_1507/val_results_test.csv
2025-11-13 15:19:19 - root - INFO - this valuation the mmr lambda = 1.0
2025-11-13 15:21:57 - __main__ - INFO - Accuracy: 53.12% (68/128), Avg NLL: 0.0030
2025-11-13 15:21:57 - __main__ - INFO - Saving evaluation results to file...
2025-11-13 15:21:57 - __main__ - INFO - Evaluation results saved to: results/rl_icl_qwen_8b_test/1113_1507/val_results_test.csv
